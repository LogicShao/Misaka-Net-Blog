---
// Misaka Network - Header Component
import { SITE_TITLE } from '../consts';
import HeaderLink from './HeaderLink.astro';
import ThemeToggle from './ThemeToggle.astro';
import SearchButton from './SearchButton.astro';
---

<header class="sticky top-0 z-50 backdrop-blur-md border-b"
        style="background-color: var(--bg-primary); border-color: var(--border-color);">
    <nav class="container mx-auto px-4 py-4 max-w-6xl">
        <div class="flex items-center justify-between">
            <!-- Logo & Title -->
            <a href="/" class="flex items-center space-x-3 group">
                <div class="relative">
                    <!-- 电磁炮图标 -->
                    <svg class="w-10 h-10 text-misaka-blue group-hover:text-misaka-circuit transition-colors duration-300"
                         viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <circle cx="12" cy="12" r="3" stroke="currentColor" stroke-width="2"
                                class="animate-pulse-slow"/>
                        <path d="M12 2L12 8M12 16L12 22M2 12L8 12M16 12L22 12" stroke="currentColor" stroke-width="2"
                              stroke-linecap="round"/>
                        <circle cx="12" cy="12" r="8" stroke="currentColor" stroke-width="1" opacity="0.3"/>
                    </svg>
                    <div class="absolute inset-0 bg-misaka-blue/20 rounded-full blur-lg animate-pulse-slow"></div>
                </div>
                <div class="flex flex-col">
					<span class="text-xl font-bold group-hover:text-misaka-blue transition-colors duration-300"
                          style="color: var(--text-primary);">
						{SITE_TITLE}
					</span>
                    <span class="text-xs text-misaka-circuit font-mono hidden sm:block">
						御坂网络 / MISAKA NETWORK
					</span>
                </div>
            </a>

            <!-- Navigation Links -->
            <div class="flex items-center space-x-6">
                <div class="hidden md:flex items-center space-x-1">
                    <HeaderLink href="/">首页</HeaderLink>
                    <HeaderLink href="/blog">博客</HeaderLink>
                    <HeaderLink href="/tags">标签</HeaderLink>
                    <HeaderLink href="/friends">友链</HeaderLink>
                    <HeaderLink href="/about">关于</HeaderLink>
                </div>

                <!-- Search Button -->
                <SearchButton />

                <!-- Theme Toggle -->
                <ThemeToggle/>

                <!-- Mobile Menu Button (for future expansion) -->
                <button
                        id="mobile-menu-button"
                        class="md:hidden p-2 hover:text-misaka-blue transition-colors"
                        style="color: var(--text-secondary);"
                        aria-label="菜单"
                        aria-expanded="false"
				>
                    <svg id="menu-icon" class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                              d="M4 6h16M4 12h16M4 18h16"/>
                    </svg>
                    <svg id="close-icon" class="w-6 h-6 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                              d="M6 18L18 6M6 6l12 12"/>
                    </svg>
                </button>
            </div>
        </div>

        <!-- Mobile Navigation (hidden by default) -->
        <div class="md:hidden mt-4 pt-4 hidden" id="mobile-menu"
             style="border-color: var(--border-color); border-top-width: 1px;">
            <div class="flex flex-col space-y-2">
                <HeaderLink href="/">首页</HeaderLink>
                <HeaderLink href="/blog">博客</HeaderLink>
                <HeaderLink href="/tags">标签</HeaderLink>
                <HeaderLink href="/friends">友链</HeaderLink>
                <HeaderLink href="/about">关于</HeaderLink>
            </div>
		</div>
	</nav>
</header>

<script>
    // 移动菜单切换功能
    const mobileMenuButton = document.getElementById('mobile-menu-button');
    const mobileMenu = document.getElementById('mobile-menu');
    const menuIcon = document.getElementById('menu-icon');
    const closeIcon = document.getElementById('close-icon');

    if (mobileMenuButton && mobileMenu && menuIcon && closeIcon) {
        mobileMenuButton.addEventListener('click', () => {
            const isExpanded = mobileMenuButton.getAttribute('aria-expanded') === 'true';

            // 切换菜单显示状态
            mobileMenu.classList.toggle('hidden');

            // 切换图标
            menuIcon.classList.toggle('hidden');
            closeIcon.classList.toggle('hidden');

            // 更新 aria-expanded 属性
            mobileMenuButton.setAttribute('aria-expanded', (!isExpanded).toString());
        });
    }
</script>
