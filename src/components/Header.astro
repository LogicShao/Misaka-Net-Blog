---
// Misaka Network - Header Component
import {SITE_TITLE} from '../consts';
import HeaderLink from './HeaderLink.astro';
import ThemeToggle from './ThemeToggle.astro';
import SearchButton from './SearchButton.astro';
---

<header class="sticky top-0 z-50 backdrop-blur-md border-b"
        style="background-color: var(--bg-primary); border-color: var(--border-color);">
  <nav class="container mx-auto px-4 py-4 max-w-6xl">
    <div class="flex items-center justify-between">
      <!-- Logo & Title -->
      <a href="/" class="flex items-center space-x-3 group">
        <div class="relative">
          <!-- ç”µç£ç‚®å›¾æ ?-->
          <svg class="w-10 h-10 text-misaka-blue group-hover:text-misaka-circuit transition-colors duration-300"
               viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <circle cx="12" cy="12" r="3" stroke="currentColor" stroke-width="2"
                    class="animate-pulse-slow"/>
            <path d="M12 2L12 8M12 16L12 22M2 12L8 12M16 12L22 12" stroke="currentColor" stroke-width="2"
                  stroke-linecap="round"/>
            <circle cx="12" cy="12" r="8" stroke="currentColor" stroke-width="1" opacity="0.3"/>
          </svg>
          <div class="absolute inset-0 bg-misaka-blue/20 rounded-full blur-lg animate-pulse-slow"></div>
        </div>
        <div class="flex flex-col">
					<span class="text-xl font-bold group-hover:text-misaka-blue transition-colors duration-300"
                style="color: var(--text-primary);">
						{SITE_TITLE}
					</span>
          <span class="text-xs text-misaka-circuit font-mono hidden sm:block">
						å¾¡å‚ç½‘ç»œ / MISAKA NETWORK
					</span>
        </div>
      </a>

      <!-- Navigation Links -->
      <div class="flex items-center space-x-6">
        <div class="hidden md:flex items-center space-x-1">
          <HeaderLink href="/">é¦–é¡µ</HeaderLink>
          <HeaderLink href="/blog">åšå®¢</HeaderLink>
          <HeaderLink href="/blog/galaxy">Galaxy</HeaderLink>
          <HeaderLink href="/tags">æ ‡ç­¾</HeaderLink>
          <HeaderLink href="/friends">å‹é“¾</HeaderLink>
          <HeaderLink href="/about">å…³äº</HeaderLink>
        </div>

        <!-- Search Button -->
        <SearchButton/>

        <!-- Theme Toggle -->
        <ThemeToggle/>

        <!-- Mobile Menu Button (for future expansion) -->
        <button
          id="mobile-menu-button"
          class="md:hidden p-2 hover:text-misaka-blue transition-colors"
          style="color: var(--text-secondary);"
          aria-label="èœå•"
          aria-expanded="false"
        >
          <svg id="menu-icon" class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M4 6h16M4 12h16M4 18h16"/>
          </svg>
          <svg id="close-icon" class="w-6 h-6 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M6 18L18 6M6 6l12 12"/>
          </svg>
        </button>
      </div>
    </div>

    <!-- Mobile Navigation (hidden by default) -->
    <div class="md:hidden mt-4 pt-4 hidden" id="mobile-menu"
         style="border-color: var(--border-color); border-top-width: 1px;">
      <div class="flex flex-col space-y-2">
        <HeaderLink href="/">é¦–é¡µ</HeaderLink>
        <HeaderLink href="/blog">åšå®¢</HeaderLink>
        <HeaderLink href="/blog/galaxy">Galaxy</HeaderLink>
        <HeaderLink href="/tags">æ ‡ç­¾</HeaderLink>
        <HeaderLink href="/friends">å‹é“¾</HeaderLink>
        <HeaderLink href="/about">å…³äº</HeaderLink>
      </div>
    </div>
  </nav>
</header>

<script>
  // ç§»åŠ¨èœå•åˆ‡æ¢åŠŸèƒ½
  const mobileMenuButton = document.getElementById('mobile-menu-button');
  const mobileMenu = document.getElementById('mobile-menu');
  const menuIcon = document.getElementById('menu-icon');
  const closeIcon = document.getElementById('close-icon');

  if (mobileMenuButton && mobileMenu && menuIcon && closeIcon) {
    mobileMenuButton.addEventListener('click', () => {
      const isExpanded = mobileMenuButton.getAttribute('aria-expanded') === 'true';

      // åˆ‡æ¢èœå•æ˜¾ç¤ºçŠ¶æ€?      mobileMenu.classList.toggle('hidden');

      // åˆ‡æ¢å›¾æ ‡
      menuIcon.classList.toggle('hidden');
      closeIcon.classList.toggle('hidden');

      // æ›´æ–° aria-expanded å±æ€?      mobileMenuButton.setAttribute('aria-expanded', (!isExpanded).toString());
    });
  }
</script>
